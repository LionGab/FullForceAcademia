{
  "name": "ğŸš€ FITNESS ACADEMY - DISRUPTIVE WHATSAPP AUTOMATION",
  "nodes": [
    {
      "parameters": {
        "path": "fitness-academy-webhook",
        "httpMethod": "POST",
        "responseMode": "responseNode",
        "options": {
          "noResponseBody": false
        }
      },
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "name": "ğŸ¯ Lead Capture Hub",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [100, 300],
      "webhookId": "fitness-academy-lead-capture",
      "notes": "Receives leads from website forms, social media, QR codes, and direct messages"
    },
    {
      "parameters": {
        "jsCode": "// DISRUPTIVE LEAD SCORING AND QUALIFICATION ENGINE\nconst input = $input.first().json;\nconst currentTime = new Date();\nconst leadData = input.body || input;\n\n// Extract lead information from multiple sources\nlet leadSource = 'unknown';\nlet contactInfo = {};\nlet qualificationScore = 0;\nlet urgencyLevel = 'low';\nlet leadIntent = 'unknown';\n\n// Determine lead source and extract data\nif (leadData.source === 'website_form') {\n  leadSource = 'website';\n  contactInfo = {\n    name: leadData.name || '',\n    phone: leadData.phone || '',\n    email: leadData.email || '',\n    interest: leadData.interest || '',\n    message: leadData.message || ''\n  };\n  qualificationScore += 30; // Website leads are pre-qualified\n} else if (leadData.source === 'facebook_ads') {\n  leadSource = 'facebook';\n  contactInfo = {\n    name: leadData.full_name || '',\n    phone: leadData.phone_number || '',\n    email: leadData.email || '',\n    ad_name: leadData.ad_name || '',\n    campaign_name: leadData.campaign_name || ''\n  };\n  qualificationScore += 25;\n} else if (leadData.source === 'instagram') {\n  leadSource = 'instagram';\n  contactInfo = {\n    name: leadData.username || '',\n    phone: leadData.phone || '',\n    dm_content: leadData.message || ''\n  };\n  qualificationScore += 20;\n} else if (leadData.source === 'qr_code') {\n  leadSource = 'qr_scan';\n  contactInfo = {\n    phone: leadData.phone || '',\n    location: leadData.scan_location || '',\n    timestamp: leadData.scan_time || ''\n  };\n  qualificationScore += 40; // QR scans show high intent\n} else if (leadData.source === 'referral') {\n  leadSource = 'referral';\n  contactInfo = {\n    name: leadData.referred_name || '',\n    phone: leadData.referred_phone || '',\n    referrer_name: leadData.referrer_name || '',\n    referrer_phone: leadData.referrer_phone || ''\n  };\n  qualificationScore += 50; // Referrals have highest conversion\n}\n\n// Advanced qualification scoring\nif (contactInfo.phone && contactInfo.phone.length >= 10) qualificationScore += 20;\nif (contactInfo.email && contactInfo.email.includes('@')) qualificationScore += 15;\nif (contactInfo.name && contactInfo.name.length > 2) qualificationScore += 10;\n\n// Intent analysis\nconst intentKeywords = {\n  high: ['quero', 'preciso', 'urgente', 'hoje', 'agora', 'matricula', 'comeÃ§ar', 'iniciar'],\n  medium: ['interesse', 'informaÃ§Ã£o', 'saber', 'conhecer', 'visitar', 'avaliar'],\n  low: ['talvez', 'futuro', 'pensar', 'considerar', 'dÃºvida']\n};\n\nconst messageText = (contactInfo.message || contactInfo.dm_content || '').toLowerCase();\nif (intentKeywords.high.some(word => messageText.includes(word))) {\n  leadIntent = 'high';\n  qualificationScore += 30;\n  urgencyLevel = 'high';\n} else if (intentKeywords.medium.some(word => messageText.includes(word))) {\n  leadIntent = 'medium';\n  qualificationScore += 15;\n  urgencyLevel = 'medium';\n} else if (intentKeywords.low.some(word => messageText.includes(word))) {\n  leadIntent = 'low';\n  qualificationScore += 5;\n}\n\n// Time-based urgency (business hours = higher urgency)\nconst hour = currentTime.getHours();\nif (hour >= 6 && hour <= 22) {\n  qualificationScore += 10;\n  if (urgencyLevel === 'low') urgencyLevel = 'medium';\n}\n\n// Determine lead temperature\nlet leadTemperature = 'cold';\nif (qualificationScore >= 80) leadTemperature = 'hot';\nelse if (qualificationScore >= 50) leadTemperature = 'warm';\n\n// Generate personalized welcome message\nlet welcomeMessage = '';\nconst firstName = (contactInfo.name || '').split(' ')[0] || 'amigo(a)';\n\nif (leadTemperature === 'hot') {\n  welcomeMessage = `ğŸ”¥ Oi ${firstName}! PERFEITO timing!\\n\\nğŸ’ª Vi que vocÃª tem INTERESSE REAL em transformar seu corpo!\\n\\nğŸ¯ Vou te fazer uma PROPOSTA IRRESISTÃVEL:\\n\\nâœ… AvaliaÃ§Ã£o fÃ­sica GRATUITA\\nâœ… Aula experimental SEM COMPROMISSO\\nâœ… Plano personalizado na hora\\n\\nğŸš€ BÃ”NUS: Se decidir hoje, ganha 2 SEMANAS GRÃTIS!\\n\\nQual seu objetivo principal? Responde aÃ­! ğŸ‘‡`;\n} else if (leadTemperature === 'warm') {\n  welcomeMessage = `ğŸ‘‹ Oi ${firstName}! Bem-vindo(a)!\\n\\nğŸ‹ï¸ Vi seu interesse na nossa academia! Que legal!\\n\\nğŸ Preparei algo ESPECIAL pra vocÃª:\\n\\nâœ… Tour completo nas instalaÃ§Ãµes\\nâœ… Conversa com personal trainer\\nâœ… AvaliaÃ§Ã£o fÃ­sica gratuita\\n\\nConta pra mim: qual seu maior desafio fitness? ğŸ’ª`;\n} else {\n  welcomeMessage = `ğŸ˜Š OlÃ¡! Obrigado pelo contato!\\n\\nğŸƒâ€â™€ï¸ Que bom ter vocÃª aqui! Nossa academia vai te surpreender!\\n\\nğŸ“‹ MENU RÃPIDO:\\n1ï¸âƒ£ *PLANOS* - Ver preÃ§os\\n2ï¸âƒ£ *HORÃRIOS* - Funcionamento\\n3ï¸âƒ£ *AGENDAR* - Visita gratuita\\n4ï¸âƒ£ *MODALIDADES* - Atividades\\n\\nO que te interessa mais? ğŸ¤”`;\n}\n\n// Clean phone number\nconst cleanPhone = (contactInfo.phone || '').replace(/[^0-9]/g, '');\n\nreturn [{\n  json: {\n    // Original data\n    originalData: leadData,\n    \n    // Processed lead information\n    leadId: `LEAD_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n    source: leadSource,\n    name: contactInfo.name || 'Lead AnÃ´nimo',\n    phone: cleanPhone,\n    email: contactInfo.email || '',\n    \n    // Qualification data\n    qualificationScore,\n    leadTemperature,\n    leadIntent,\n    urgencyLevel,\n    \n    // Communication\n    welcomeMessage,\n    \n    // Timestamps\n    capturedAt: currentTime.toISOString(),\n    timezone: 'America/Sao_Paulo',\n    \n    // Workflow control\n    shouldSendImmediate: leadTemperature === 'hot',\n    followUpSequence: leadTemperature,\n    \n    // Analytics\n    expectedConversionRate: leadTemperature === 'hot' ? 0.4 : leadTemperature === 'warm' ? 0.25 : 0.15,\n    estimatedValue: leadTemperature === 'hot' ? 1200 : leadTemperature === 'warm' ? 800 : 400\n  }\n}];"
      },
      "id": "b2c3d4e5-f6g7-8901-bcde-f23456789012",
      "name": "ğŸ§  AI Lead Qualification Engine",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [340, 300],
      "notes": "Advanced AI-powered lead scoring with behavioral analysis and intent detection"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "serviceAccountEmail": "zbenzap-sniper@stellar-verve-457002-p2.iam.gserviceaccount.com",
        "operation": "appendOrUpdate",
        "documentId": "{{ $vars.GOOGLE_SHEETS_LEADS_ID }}",
        "sheetName": "Leads_Dashboard",
        "columnToMatchOn": "A",
        "valueToMatchOn": "={{ $json.leadId }}",
        "valuesToSend": {
          "specifyColumns": "defineBelow",
          "columnsToSend": {
            "A": "={{ $json.leadId }}",
            "B": "={{ $json.capturedAt }}",
            "C": "={{ $json.name }}",
            "D": "={{ $json.phone }}",
            "E": "={{ $json.email }}",
            "F": "={{ $json.source }}",
            "G": "={{ $json.qualificationScore }}",
            "H": "={{ $json.leadTemperature }}",
            "I": "={{ $json.leadIntent }}",
            "J": "={{ $json.urgencyLevel }}",
            "K": "={{ $json.expectedConversionRate }}",
            "L": "={{ $json.estimatedValue }}",
            "M": "CAPTURED",
            "N": "Aguardando primeiro contato",
            "O": "={{ new Date().toISOString() }}"
          }
        }
      },
      "id": "c3d4e5f6-g7h8-9012-cdef-345678901234",
      "name": "ğŸ“Š Log to Analytics Dashboard",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [580, 200],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "google-sheets-credentials",
          "name": "Google Sheets Fitness Academy"
        }
      },
      "notes": "Real-time lead tracking in Google Sheets with comprehensive analytics"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false
          },
          "conditions": [
            {
              "leftValue": "={{ $json.phone }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "isNotEmpty"
              }
            },
            {
              "leftValue": "={{ $json.phone.length }}",
              "rightValue": 10,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "and"
        }
      },
      "id": "d4e5f6g7-h8i9-0123-def0-456789012345",
      "name": "âœ… Validate Contact Info",
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2,
      "position": [580, 400],
      "notes": "Ensures lead has valid phone number before WhatsApp outreach"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false
          },
          "conditions": [
            {
              "leftValue": "={{ $json.shouldSendImmediate }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equal"
              }
            }
          ]
        }
      },
      "id": "e5f6g7h8-i9j0-1234-ef01-567890123456",
      "name": "ğŸ”¥ Hot Lead Filter",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [820, 300]
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "send",
        "phoneNumberId": "{{ $vars.WHATSAPP_PHONE_ID }}",
        "recipientPhoneNumber": "55{{ $json.phone }}",
        "messageType": "interactive",
        "interactiveMessageType": "button",
        "bodyText": "{{ $json.welcomeMessage }}",
        "buttonParameters": {
          "values": [
            {
              "text": "ğŸ¯ QUERO CONHECER!",
              "id": "hot_lead_interested"
            },
            {
              "text": "ğŸ“ FALAR COM CONSULTOR",
              "id": "hot_lead_consultant"
            },
            {
              "text": "ğŸ“… AGENDAR VISITA",
              "id": "hot_lead_schedule"
            }
          ]
        },
        "footerText": "Academia Fitness Pro - Transforme seu corpo hoje!"
      },
      "id": "f6g7h8i9-j0k1-2345-f012-678901234567",
      "name": "âš¡ Instant Hot Lead Response",
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [1060, 200],
      "credentials": {
        "whatsAppApi": {
          "id": "whatsapp-business-credentials",
          "name": "WhatsApp Business API"
        }
      },
      "notes": "Immediate interactive response for high-intent leads"
    },
    {
      "parameters": {
        "amount": 180,
        "unit": "seconds"
      },
      "id": "g7h8i9j0-k1l2-3456-0123-789012345678",
      "name": "â° Smart Timing Buffer",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [820, 500],
      "notes": "Strategic delay for warm/cold leads - optimal response timing"
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "send",
        "phoneNumberId": "{{ $vars.WHATSAPP_PHONE_ID }}",
        "recipientPhoneNumber": "55{{ $json.phone }}",
        "messageType": "interactive",
        "interactiveMessageType": "list",
        "bodyText": "{{ $json.welcomeMessage }}",
        "listParameters": {
          "buttonText": "ğŸ“‹ ESCOLHER OPÃ‡ÃƒO",
          "title": "Como posso ajudar?",
          "sections": [
            {
              "title": "ğŸ¯ INFORMAÃ‡Ã•ES",
              "rows": [
                {
                  "id": "info_plans",
                  "title": "ğŸ’° Planos e PreÃ§os",
                  "description": "ConheÃ§a nossos planos especiais"
                },
                {
                  "id": "info_schedule",
                  "title": "ğŸ• HorÃ¡rios",
                  "description": "Funcionamento e aulas"
                },
                {
                  "id": "info_activities",
                  "title": "ğŸ‹ï¸ Modalidades",
                  "description": "Todas as atividades disponÃ­veis"
                }
              ]
            },
            {
              "title": "ğŸš€ AÃ‡ÃƒO IMEDIATA",
              "rows": [
                {
                  "id": "action_visit",
                  "title": "ğŸ“… Agendar Visita",
                  "description": "Tour gratuito + avaliaÃ§Ã£o"
                },
                {
                  "id": "action_trial",
                  "title": "ğŸ Aula Experimental",
                  "description": "Treino gratuito hoje"
                },
                {
                  "id": "action_consultant",
                  "title": "ğŸ‘¨â€ğŸ’¼ Falar com Consultor",
                  "description": "Atendimento personalizado"
                }
              ]
            }
          ]
        },
        "footerText": "Resposta em menos de 2 minutos âš¡"
      },
      "id": "h8i9j0k1-l2m3-4567-1234-890123456789",
      "name": "ğŸ“± Interactive Menu Response",
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [1060, 500],
      "credentials": {
        "whatsAppApi": {
          "id": "whatsapp-business-credentials",
          "name": "WhatsApp Business API"
        }
      },
      "notes": "Smart interactive menu for warm/cold leads with multiple engagement options"
    },
    {
      "parameters": {
        "path": "whatsapp-responses",
        "httpMethod": "POST",
        "responseMode": "responseNode",
        "options": {
          "noResponseBody": false
        }
      },
      "id": "i9j0k1l2-m3n4-5678-2345-901234567890",
      "name": "ğŸ’¬ WhatsApp Response Handler",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [100, 800],
      "webhookId": "whatsapp-responses",
      "notes": "Handles all incoming WhatsApp messages and interactions"
    },
    {
      "parameters": {
        "jsCode": "// ADVANCED AI RESPONSE PROCESSOR WITH SENTIMENT ANALYSIS\nconst webhookData = $input.first().json;\nconst messages = webhookData.entry?.[0]?.changes?.[0]?.value?.messages || [];\nconst contacts = webhookData.entry?.[0]?.changes?.[0]?.value?.contacts || [];\n\nif (messages.length === 0) {\n  return [{ json: { no_messages: true } }];\n}\n\nconst items = [];\n\nfor (const message of messages) {\n  const contact = contacts.find(c => c.wa_id === message.from) || {};\n  const messageText = (message.text?.body || '').toLowerCase();\n  const messageType = message.type;\n  \n  // Enhanced Intent Recognition with AI\n  let intent = 'unknown';\n  let confidence = 0;\n  let sentiment = 'neutral';\n  let urgency = 'normal';\n  let suggestedResponse = '';\n  let actionRequired = 'auto_respond';\n  let leadScore = 0;\n  \n  // Sentiment Analysis Keywords\n  const positiveWords = ['Ã³timo', 'excelente', 'perfeito', 'adorei', 'incrÃ­vel', 'maravilhoso', 'sim', 'quero', 'interessado'];\n  const negativeWords = ['nÃ£o', 'nao', 'ruim', 'caro', 'longe', 'difÃ­cil', 'complicado', 'problema'];\n  const urgentWords = ['urgente', 'hoje', 'agora', 'imediato', 'rÃ¡pido', 'pressa'];\n  \n  // Calculate sentiment\n  const positiveCount = positiveWords.filter(word => messageText.includes(word)).length;\n  const negativeCount = negativeWords.filter(word => messageText.includes(word)).length;\n  const urgentCount = urgentWords.filter(word => messageText.includes(word)).length;\n  \n  if (positiveCount > negativeCount) {\n    sentiment = 'positive';\n    leadScore += 20;\n  } else if (negativeCount > positiveCount) {\n    sentiment = 'negative';\n    leadScore -= 10;\n  }\n  \n  if (urgentCount > 0) {\n    urgency = 'high';\n    leadScore += 15;\n  }\n  \n  // Advanced Intent Detection\n  if (/(quero|interessado|me inscrevo|vou comeÃ§ar|quero comeÃ§ar)/i.test(messageText)) {\n    intent = 'ready_to_join';\n    confidence = 0.95;\n    leadScore += 50;\n    actionRequired = 'schedule_immediate';\n    suggestedResponse = `ğŸ‰ SENSACIONAL! Que energia boa!\\n\\nğŸš€ Vou agendar sua avaliaÃ§Ã£o HOJE mesmo!\\n\\nEscolha seu horÃ¡rio preferido:\\n\\nâ° HOJE:\\nâ€¢ 14h00 - DisponÃ­vel\\nâ€¢ 16h30 - DisponÃ­vel\\nâ€¢ 19h00 - DisponÃ­vel\\n\\nğŸ“ Academia Fitness Pro\\nRua Principal, 123\\n\\nğŸ’ª Prepare-se para TRANSFORMAR sua vida!\\n\\nQual horÃ¡rio Ã© perfeito pra vocÃª?`;\n  } else if (/(preÃ§o|valor|plano|mensalidade|quanto custa)/i.test(messageText)) {\n    intent = 'pricing_inquiry';\n    confidence = 0.9;\n    leadScore += 30;\n    suggestedResponse = `ğŸ’° PLANOS ESPECIAIS - SETEMBRO 2024\\n\\nğŸ”¥ SUPER PROMOÃ‡ÃƒO:\\n\\nğŸ¥‡ PLANO PREMIUM\\nâ€¢ R$ 89,90/mÃªs (era R$ 129,90)\\nâ€¢ TODAS as modalidades\\nâ€¢ Personal trainer 2x/mÃªs\\nâ€¢ AvaliaÃ§Ã£o mensal\\n\\nğŸ¥ˆ PLANO BÃSICO\\nâ€¢ R$ 59,90/mÃªs (era R$ 79,90)\\nâ€¢ MusculaÃ§Ã£o + 1 modalidade\\nâ€¢ AvaliaÃ§Ã£o fÃ­sica\\n\\nğŸ BÃ”NUS HOJE:\\nâ€¢ MatrÃ­cula GRÃTIS (economia R$ 150)\\nâ€¢ 1 semana grÃ¡tis\\nâ€¢ Kit academia de brinde\\n\\nâ° OFERTA VÃLIDA ATÃ‰ AMANHÃƒ!\\n\\nQual plano faz mais sentido pra vocÃª?`;\n  } else if (/(agendar|marcar|visita|conhecer|ver|tour)/i.test(messageText)) {\n    intent = 'schedule_visit';\n    confidence = 0.88;\n    leadScore += 35;\n    suggestedResponse = `ğŸ“… PERFEITO! Vou agendar sua visita VIP!\\n\\nğŸ¯ O QUE VOCÃŠ VAI GANHAR:\\n\\nâœ… Tour completo (15 min)\\nâœ… AvaliaÃ§Ã£o fÃ­sica gratuita\\nâœ… Plano personalizado\\nâœ… Aula experimental\\nâœ… Consultoria nutricional\\n\\nğŸ“‹ HORÃRIOS HOJE:\\n\\nğŸŒ… MANHÃƒ: 8h | 10h\\nğŸŒ TARDE: 14h | 16h\\nğŸŒ™ NOITE: 18h | 20h\\n\\nğŸ’ BÃ”NUS VISITA:\\nSe decidir hoje = 2 SEMANAS GRÃTIS!\\n\\nQue horÃ¡rio funciona melhor?`;\n  } else if (/(horÃ¡rio|horario|funciona|abre|fecha|quando)/i.test(messageText)) {\n    intent = 'schedule_info';\n    confidence = 0.85;\n    leadScore += 10;\n    suggestedResponse = `ğŸ• HORÃRIOS DE FUNCIONAMENTO\\n\\nğŸ“… SEGUNDA A SEXTA:\\nâ€¢ ManhÃ£: 06h00 Ã s 12h00\\nâ€¢ Tarde: 13h30 Ã s 23h00\\n\\nğŸ“… SÃBADOS:\\nâ€¢ 08h00 Ã s 18h00\\n\\nğŸ“… DOMINGOS:\\nâ€¢ 08h00 Ã s 16h00\\n\\nğŸ”¥ HORÃRIOS DE PICO (mais movimento):\\nâ€¢ 07h-09h | 18h-21h\\n\\nğŸ˜Œ HORÃRIOS TRANQUILOS:\\nâ€¢ 09h-17h | 21h-23h\\n\\nğŸ’ª Qual perÃ­odo vocÃª prefere treinar?\\n\\nğŸ Quer agendar um horÃ¡rio pra conhecer?`;\n  } else if (/(modalidade|atividade|treino|aula|exercÃ­cio)/i.test(messageText)) {\n    intent = 'activities_info';\n    confidence = 0.82;\n    leadScore += 15;\n    suggestedResponse = `ğŸ‹ï¸ MODALIDADES DISPONÃVEIS\\n\\nğŸ’ª MUSCULAÃ‡ÃƒO\\nâ€¢ Equipamentos modernos\\nâ€¢ Acompanhamento profissional\\n\\nğŸ§˜â€â™€ï¸ AULAS COLETIVAS:\\nâ€¢ Zumba (Seg/Qua/Sex - 19h)\\nâ€¢ Yoga (Ter/Qui - 19h)\\nâ€¢ Pilates (SÃ¡b - 9h)\\nâ€¢ Spinning (Seg/Qua/Sex - 7h)\\n\\nğŸ¥Š LUTAS:\\nâ€¢ Boxe (Ter/Qui - 20h)\\nâ€¢ Muay Thai (Seg/Qua/Sex - 20h)\\n\\nğŸŠâ€â™‚ï¸ AQUÃTICOS:\\nâ€¢ HidroginÃ¡stica (Ter/Qui - 16h)\\nâ€¢ NataÃ§Ã£o (livre)\\n\\nğŸ¯ Qual atividade desperta seu interesse?\\n\\nğŸ Aula experimental GRATUITA!`;\n  } else if (/(nÃ£o|nao|sem interesse|parar|cancelar)/i.test(messageText)) {\n    intent = 'not_interested';\n    confidence = 0.9;\n    actionRequired = 'human_intervention';\n    suggestedResponse = `ğŸ˜Š Tudo bem! Respeitamos sua decisÃ£o.\\n\\nğŸ¤ Se um dia mudar de ideia, estaremos aqui!\\n\\nğŸ’š Desejamos muito sucesso nos seus objetivos!\\n\\nğŸ“± Este chat ficarÃ¡ sempre disponÃ­vel pra vocÃª.`;\n  } else if (/(emergÃªncia|problema|reclamaÃ§Ã£o|urgente)/i.test(messageText)) {\n    intent = 'urgent_issue';\n    confidence = 0.95;\n    urgency = 'critical';\n    actionRequired = 'immediate_human';\n    suggestedResponse = `âš ï¸ Entendi que Ã© urgente!\\n\\nğŸ‘¨â€ğŸ’¼ Vou conectar vocÃª AGORA com nosso gerente:\\n\\nğŸ“ WhatsApp Direto: (65) 9999-8888\\nğŸ“ Telefone: (65) 3333-4444\\n\\nâ° Resposta em menos de 5 minutos!`;\n  } else {\n    // Default intelligent response with personalization\n    const firstName = contact.profile?.name?.split(' ')[0] || 'amigo(a)';\n    suggestedResponse = `Oi ${firstName}! ğŸ˜Š\\n\\nğŸ¤– Sou a assistente da Academia Fitness Pro!\\n\\nğŸ“‹ MENU RÃPIDO:\\n\\nğŸ’° Digite *PLANOS* - PreÃ§os especiais\\nğŸ“… Digite *AGENDAR* - Visita gratuita\\nğŸ‹ï¸ Digite *MODALIDADES* - Atividades\\nğŸ• Digite *HORÃRIOS* - Funcionamento\\nğŸ‘¨â€ğŸ’¼ Digite *CONSULTOR* - Falar com humano\\n\\nOu me conte: qual seu objetivo fitness? ğŸ’ª`;\n  }\n  \n  // Personalization based on message history (simulate)\n  const isReturningLead = messageText.includes('voltando') || messageText.includes('de volta');\n  if (isReturningLead) {\n    leadScore += 25;\n    suggestedResponse = `ğŸ”„ Que bom ter vocÃª de volta!\\n\\n` + suggestedResponse;\n  }\n  \n  items.push({\n    json: {\n      phone: message.from,\n      name: contact.profile?.name || 'Lead',\n      messageReceived: message.text?.body || '',\n      messageType,\n      intent,\n      confidence,\n      sentiment,\n      urgency,\n      leadScore,\n      suggestedResponse,\n      actionRequired,\n      messageId: message.id,\n      timestamp: new Date().toISOString(),\n      \n      // Advanced analytics\n      wordCount: messageText.split(' ').length,\n      hasEmojis: /[\\u{1F600}-\\u{1F6FF}]/u.test(message.text?.body || ''),\n      responseTime: 'immediate',\n      \n      // Business intelligence\n      expectedConversion: intent === 'ready_to_join' ? 0.8 : intent === 'schedule_visit' ? 0.6 : 0.3,\n      estimatedValue: intent === 'ready_to_join' ? 1200 : intent === 'schedule_visit' ? 800 : 400,\n      nextBestAction: actionRequired\n    }\n  });\n}\n\nreturn items;"
      },
      "id": "j0k1l2m3-n4o5-6789-3456-012345678901",
      "name": "ğŸ¤– AI Response Intelligence",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [340, 800],
      "notes": "Advanced AI with sentiment analysis, intent detection, and personalized responses"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "serviceAccountEmail": "zbenzap-sniper@stellar-verve-457002-p2.iam.gserviceaccount.com",
        "operation": "appendOrUpdate",
        "documentId": "{{ $vars.GOOGLE_SHEETS_LEADS_ID }}",
        "sheetName": "Conversations_Analytics",
        "columnToMatchOn": "A",
        "valueToMatchOn": "={{ $json.phone }}",
        "valuesToSend": {
          "specifyColumns": "defineBelow",
          "columnsToSend": {
            "A": "={{ $json.phone }}",
            "B": "={{ $json.name }}",
            "C": "={{ $json.timestamp }}",
            "D": "={{ $json.messageReceived }}",
            "E": "={{ $json.intent }}",
            "F": "={{ $json.confidence }}",
            "G": "={{ $json.sentiment }}",
            "H": "={{ $json.urgency }}",
            "I": "={{ $json.leadScore }}",
            "J": "={{ $json.actionRequired }}",
            "K": "={{ $json.expectedConversion }}",
            "L": "={{ $json.estimatedValue }}",
            "M": "ANALYZED",
            "N": "{{ new Date().toISOString() }}"
          }
        }
      },
      "id": "k1l2m3n4-o5p6-7890-4567-123456789012",
      "name": "ğŸ“ˆ Conversation Analytics",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [580, 700],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "google-sheets-credentials",
          "name": "Google Sheets Fitness Academy"
        }
      },
      "notes": "Real-time conversation analytics with AI insights"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false
          },
          "conditions": [
            {
              "leftValue": "={{ $json.actionRequired }}",
              "rightValue": "auto_respond",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ]
        }
      },
      "id": "l2m3n4o5-p6q7-8901-5678-234567890123",
      "name": "ğŸ¤– Auto Response Filter",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [580, 900]
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "send",
        "phoneNumberId": "{{ $vars.WHATSAPP_PHONE_ID }}",
        "recipientPhoneNumber": "{{ $json.phone }}",
        "messageType": "text",
        "textBody": "{{ $json.suggestedResponse }}"
      },
      "id": "m3n4o5p6-q7r8-9012-6789-345678901234",
      "name": "ğŸ’¬ AI Auto Response",
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [820, 900],
      "credentials": {
        "whatsAppApi": {
          "id": "whatsapp-business-credentials",
          "name": "WhatsApp Business API"
        }
      },
      "notes": "Sends AI-generated personalized responses automatically"
    },
    {
      "parameters": {
        "triggerTimes": {
          "item": [
            {
              "hour": 9,
              "minute": 0
            }
          ]
        }
      },
      "id": "n4o5p6q7-r8s9-0123-7890-456789012345",
      "name": "â° Daily Follow-up Trigger",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 1,
      "position": [100, 1200],
      "notes": "Triggers daily follow-up sequences for leads"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "serviceAccountEmail": "zbenzap-sniper@stellar-verve-457002-p2.iam.gserviceaccount.com",
        "operation": "read",
        "documentId": "{{ $vars.GOOGLE_SHEETS_LEADS_ID }}",
        "sheetName": "Leads_Dashboard",
        "range": "A:O",
        "options": {
          "firstLineHeaders": true
        }
      },
      "id": "o5p6q7r8-s9t0-1234-8901-567890123456",
      "name": "ğŸ“‹ Get Leads for Follow-up",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [340, 1200],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "google-sheets-credentials",
          "name": "Google Sheets Fitness Academy"
        }
      },
      "notes": "Retrieves leads that need follow-up"
    },
    {
      "parameters": {
        "jsCode": "// BEHAVIORAL FOLLOW-UP SEQUENCING ENGINE\nconst items = [];\nconst now = new Date();\nconst leads = $input.all();\n\nfor (const leadItem of leads) {\n  const lead = leadItem.json;\n  \n  // Skip if no phone or status is converted\n  if (!lead.phone || lead.status === 'CONVERTED') continue;\n  \n  const capturedDate = new Date(lead.capturedAt || lead.timestamp);\n  const hoursSinceCapture = (now - capturedDate) / (1000 * 60 * 60);\n  const daysSinceCapture = Math.floor(hoursSinceCapture / 24);\n  \n  let shouldFollowUp = false;\n  let followUpMessage = '';\n  let followUpType = '';\n  let urgencyLevel = 'normal';\n  \n  // Behavioral Follow-up Logic\n  if (lead.leadTemperature === 'hot' && hoursSinceCapture >= 4 && hoursSinceCapture <= 24) {\n    shouldFollowUp = true;\n    followUpType = 'hot_lead_4h';\n    urgencyLevel = 'high';\n    followUpMessage = `ğŸ”¥ Oi ${lead.name.split(' ')[0]}!\\n\\nVi que vocÃª demonstrou INTERESSE REAL na academia mais cedo!\\n\\nâš¡ OFERTA RELÃ‚MPAGO - PRÃ“XIMAS 2 HORAS:\\n\\nğŸ MATRÃCULA + 1 MÃŠS GRÃTIS\\nğŸ Kit academia completo\\nğŸ AvaliaÃ§Ã£o fÃ­sica premium\\n\\nğŸ’° ECONOMIA TOTAL: R$ 387!\\n\\nâ° Oferta vÃ¡lida ATÃ‰ 21h hoje!\\n\\nVem garantir sua vaga! Responde SIM! ğŸ’ª`;\n  } else if (lead.leadTemperature === 'warm' && daysSinceCapture === 1) {\n    shouldFollowUp = true;\n    followUpType = 'warm_lead_1d';\n    followUpMessage = `ğŸ˜Š Oi ${lead.name.split(' ')[0]}! Tudo bem?\\n\\nğŸ’­ Ainda pensando sobre entrar em forma?\\n\\nğŸ¯ Que tal esclarecer algumas dÃºvidas? Preparei um GUIA EXCLUSIVO pra vocÃª:\\n\\nğŸ“± Link: academia.fitness/guia-${lead.leadId}\\n\\nâœ… Resultados reais de alunos\\nâœ… Planos detalhados\\nâœ… Metodologia exclusiva\\n\\nğŸ’¬ E se tiver qualquer pergunta, Ã© sÃ³ responder aqui!\\n\\nQual sua maior dÃºvida sobre academia? ğŸ¤”`;\n  } else if (lead.leadTemperature === 'cold' && daysSinceCapture === 3) {\n    shouldFollowUp = true;\n    followUpType = 'cold_lead_3d';\n    followUpMessage = `ğŸ‘‹ Oi ${lead.name.split(' ')[0]}!\\n\\nğŸƒâ€â™€ï¸ Que tal comeÃ§ar sua transformaÃ§Ã£o ainda esta semana?\\n\\nğŸ“¸ Olha sÃ³ estes RESULTADOS REAIS dos nossos alunos:\\n\\nğŸ’ª Maria - perdeu 12kg em 3 meses\\nğŸ’ª JoÃ£o - ganhou 8kg de mÃºsculo\\nğŸ’ª Ana - eliminou 15cm da cintura\\n\\nğŸ PROMOÃ‡ÃƒO ESPECIAL:\\nâ€¢ AvaliaÃ§Ã£o gratuita\\nâ€¢ 1 semana experimental\\nâ€¢ Plano personalizado\\n\\nQuer ser o prÃ³ximo caso de sucesso? ğŸš€`;\n  } else if (daysSinceCapture === 7) {\n    shouldFollowUp = true;\n    followUpType = 'weekly_nurture';\n    followUpMessage = `ğŸ’ª Oi ${lead.name.split(' ')[0]}!\\n\\nğŸ—“ï¸ Uma semana se passou... Como andam seus objetivos de saÃºde?\\n\\nğŸ’¡ DICA SEMANAL:\\n\\\"O melhor treino Ã© aquele que vocÃª faz de forma consistente!\\\"\\n\\nğŸ† DESAFIO DA SEMANA:\\nâ€¢ 30 minutos de caminhada por dia\\nâ€¢ 2 litros de Ã¡gua\\nâ€¢ 8 horas de sono\\n\\nğŸ¤ E que tal ter ajuda profissional para acelerar seus resultados?\\n\\nQuer agendar uma conversa? Ã‰ sÃ³ dizer OI! ğŸ˜Š`;\n  } else if (daysSinceCapture === 30) {\n    shouldFollowUp = true;\n    followUpType = 'monthly_reactivation';\n    urgencyLevel = 'high';\n    followUpMessage = `ğŸ¯ ${lead.name.split(' ')[0]}, ainda lembra de mim?\\n\\nğŸ“… Faz 1 mÃªs que vocÃª demonstrou interesse em cuidar da sua saÃºde...\\n\\nâ“ O que mudou nesse tempo?\\nâ“ Seus objetivos continuam os mesmos?\\nâ“ Que tal uma NOVA OPORTUNIDADE?\\n\\nğŸš€ OFERTA ESPECIAL - SÃ“ PRA VOCÃŠ:\\n\\nğŸ 2 MESES pelo preÃ§o de 1\\nğŸ Personal trainer incluso\\nğŸ Acompanhamento nutricional\\n\\nğŸ’ Porque sua saÃºde nÃ£o pode esperar mais!\\n\\nVamos conversar? Digite QUERO!`;\n  }\n  \n  if (shouldFollowUp) {\n    items.push({\n      json: {\n        ...lead,\n        followUpMessage,\n        followUpType,\n        urgencyLevel,\n        daysSinceCapture,\n        hoursSinceCapture: Math.round(hoursSinceCapture),\n        followUpTimestamp: now.toISOString(),\n        expectedResponse: followUpType.includes('hot') ? 0.4 : followUpType.includes('warm') ? 0.25 : 0.15\n      }\n    });\n  }\n}\n\n// Sort by urgency (high first)\nreturn items.sort((a, b) => {\n  if (a.json.urgencyLevel === 'high' && b.json.urgencyLevel !== 'high') return -1;\n  if (b.json.urgencyLevel === 'high' && a.json.urgencyLevel !== 'high') return 1;\n  return 0;\n});"
      },
      "id": "p6q7r8s9-t0u1-2345-9012-678901234567",
      "name": "ğŸ¯ Behavioral Follow-up Engine",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [580, 1200],
      "notes": "AI-powered behavioral triggers based on lead engagement patterns"
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "send",
        "phoneNumberId": "{{ $vars.WHATSAPP_PHONE_ID }}",
        "recipientPhoneNumber": "55{{ $json.phone }}",
        "messageType": "text",
        "textBody": "{{ $json.followUpMessage }}"
      },
      "id": "q7r8s9t0-u1v2-3456-0123-789012345678",
      "name": "ğŸ“¤ Send Follow-up Messages",
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [820, 1200],
      "credentials": {
        "whatsAppApi": {
          "id": "whatsapp-business-credentials",
          "name": "WhatsApp Business API"
        }
      },
      "notes": "Sends personalized follow-up messages based on behavioral triggers"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "serviceAccountEmail": "zbenzap-sniper@stellar-verve-457002-p2.iam.gserviceaccount.com",
        "operation": "appendOrUpdate",
        "documentId": "{{ $vars.GOOGLE_SHEETS_LEADS_ID }}",
        "sheetName": "Follow_Up_Analytics",
        "columnToMatchOn": "A",
        "valueToMatchOn": "{{ $json.leadId }}_{{ $json.followUpType }}",
        "valuesToSend": {
          "specifyColumns": "defineBelow",
          "columnsToSend": {
            "A": "{{ $json.leadId }}_{{ $json.followUpType }}",
            "B": "{{ $json.leadId }}",
            "C": "{{ $json.phone }}",
            "D": "{{ $json.name }}",
            "E": "{{ $json.followUpType }}",
            "F": "{{ $json.daysSinceCapture }}",
            "G": "{{ $json.urgencyLevel }}",
            "H": "{{ $json.expectedResponse }}",
            "I": "SENT",
            "J": "{{ $json.followUpTimestamp }}",
            "K": "Aguardando resposta",
            "L": "{{ new Date().toISOString() }}"
          }
        }
      },
      "id": "r8s9t0u1-v2w3-4567-1234-890123456789",
      "name": "ğŸ“Š Log Follow-up Analytics",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [1060, 1200],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "google-sheets-credentials",
          "name": "Google Sheets Fitness Academy"
        }
      },
      "notes": "Tracks follow-up performance and conversion rates"
    },
    {
      "parameters": {
        "triggerTimes": {
          "item": [
            {
              "hour": 18,
              "minute": 0
            }
          ]
        }
      },
      "id": "s9t0u1v2-w3x4-5678-2345-901234567890",
      "name": "ğŸ“ˆ Daily ROI Analytics",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 1,
      "position": [100, 1500],
      "notes": "Daily ROI calculation and performance optimization"
    },
    {
      "parameters": {
        "jsCode": "// COMPREHENSIVE ROI AND PERFORMANCE ANALYTICS ENGINE\nconst now = new Date();\nconst yesterday = new Date(now - 24 * 60 * 60 * 1000);\nconst thisWeek = new Date(now - 7 * 24 * 60 * 60 * 1000);\nconst thisMonth = new Date(now - 30 * 24 * 60 * 60 * 1000);\n\n// Simulated data - in production, this would fetch from Google Sheets\nconst analytics = {\n  daily: {\n    leads_captured: Math.floor(Math.random() * 25) + 15,\n    messages_sent: Math.floor(Math.random() * 100) + 50,\n    responses_received: Math.floor(Math.random() * 40) + 20,\n    visits_scheduled: Math.floor(Math.random() * 8) + 3,\n    conversions: Math.floor(Math.random() * 3) + 1,\n    revenue_generated: (Math.floor(Math.random() * 3) + 1) * 150 // conversions * average_plan\n  },\n  weekly: {\n    leads_captured: Math.floor(Math.random() * 150) + 100,\n    messages_sent: Math.floor(Math.random() * 600) + 400,\n    responses_received: Math.floor(Math.random() * 250) + 150,\n    visits_scheduled: Math.floor(Math.random() * 50) + 25,\n    conversions: Math.floor(Math.random() * 20) + 10,\n    revenue_generated: (Math.floor(Math.random() * 20) + 10) * 150\n  },\n  monthly: {\n    leads_captured: Math.floor(Math.random() * 500) + 400,\n    messages_sent: Math.floor(Math.random() * 2000) + 1500,\n    responses_received: Math.floor(Math.random() * 800) + 600,\n    visits_scheduled: Math.floor(Math.random() * 150) + 100,\n    conversions: Math.floor(Math.random() * 60) + 40,\n    revenue_generated: (Math.floor(Math.random() * 60) + 40) * 150\n  }\n};\n\n// Calculate key metrics\nconst metrics = {};\n\nfor (const period of ['daily', 'weekly', 'monthly']) {\n  const data = analytics[period];\n  \n  metrics[period] = {\n    ...data,\n    response_rate: (data.responses_received / data.messages_sent * 100).toFixed(2),\n    visit_conversion_rate: (data.visits_scheduled / data.responses_received * 100).toFixed(2),\n    sales_conversion_rate: (data.conversions / data.visits_scheduled * 100).toFixed(2),\n    revenue_per_lead: (data.revenue_generated / data.leads_captured).toFixed(2),\n    roi_percentage: ((data.revenue_generated - (data.messages_sent * 0.05)) / (data.messages_sent * 0.05) * 100).toFixed(2), // Assuming R$0.05 per message cost\n    cost_per_acquisition: ((data.messages_sent * 0.05) / data.conversions).toFixed(2),\n    lifetime_value_projection: (data.conversions * 150 * 12).toFixed(2) // 12 months average retention\n  };\n}\n\n// Generate insights and recommendations\nconst insights = [];\nconst recommendations = [];\n\n// Response rate analysis\nif (parseFloat(metrics.daily.response_rate) > 40) {\n  insights.push('ğŸ“ˆ Excelente taxa de resposta! Mensagens altamente relevantes.');\n} else if (parseFloat(metrics.daily.response_rate) < 25) {\n  insights.push('âš ï¸ Taxa de resposta baixa. Revisar estratÃ©gia de mensagens.');\n  recommendations.push('Testar novos templates de mensagem com A/B testing');\n}\n\n// Conversion rate analysis\nif (parseFloat(metrics.daily.sales_conversion_rate) > 35) {\n  insights.push('ğŸ¯ Taxa de conversÃ£o excepcional! Processo de vendas otimizado.');\n} else if (parseFloat(metrics.daily.sales_conversion_rate) < 20) {\n  insights.push('ğŸ” Oportunidade de melhoria na conversÃ£o de visitas.');\n  recommendations.push('Implementar follow-up mais agressivo pÃ³s-visita');\n}\n\n// ROI analysis\nif (parseFloat(metrics.daily.roi_percentage) > 500) {\n  insights.push('ğŸ’° ROI excelente! EstratÃ©gia altamente lucrativa.');\n} else if (parseFloat(metrics.daily.roi_percentage) < 200) {\n  insights.push('ğŸ’¡ ROI pode ser otimizado. Focar em leads de maior qualidade.');\n  recommendations.push('Ajustar segmentaÃ§Ã£o para leads mais qualificados');\n}\n\n// Behavioral insights\nconst peakHour = Math.floor(Math.random() * 12) + 8; // Random between 8-20h\ninsights.push(`â° Pico de engajamento: ${peakHour}h - Concentrar envios neste horÃ¡rio`);\n\nif (metrics.daily.leads_captured > 20) {\n  insights.push('ğŸš€ Volume alto de leads! Garantir follow-up rÃ¡pido para nÃ£o perder oportunidades.');\n  recommendations.push('Considerar automatizaÃ§Ã£o adicional para alto volume');\n}\n\n// Generate performance report\nconst performanceReport = {\n  timestamp: now.toISOString(),\n  period: 'daily_summary',\n  metrics,\n  insights,\n  recommendations,\n  \n  // Performance alerts\n  alerts: [\n    {\n      type: metrics.daily.response_rate < 25 ? 'warning' : 'success',\n      message: `Taxa de resposta: ${metrics.daily.response_rate}%`,\n      action_required: metrics.daily.response_rate < 25\n    },\n    {\n      type: metrics.daily.conversions < 2 ? 'warning' : 'success',\n      message: `ConversÃµes hoje: ${metrics.daily.conversions}`,\n      action_required: metrics.daily.conversions < 2\n    }\n  ],\n  \n  // Optimization suggestions\n  optimizations: [\n    {\n      category: 'messaging',\n      suggestion: 'Testar mensagens com maior urgÃªncia nos primeiros contatos',\n      expected_impact: '+15% taxa de resposta',\n      effort: 'baixo'\n    },\n    {\n      category: 'timing',\n      suggestion: `Concentrar envios entre ${peakHour-1}h e ${peakHour+1}h`,\n      expected_impact: '+10% engajamento',\n      effort: 'baixo'\n    },\n    {\n      category: 'segmentation',\n      suggestion: 'Criar sequÃªncias diferentes por fonte de lead',\n      expected_impact: '+20% conversÃ£o',\n      effort: 'mÃ©dio'\n    }\n  ],\n  \n  // Next day predictions\n  predictions: {\n    expected_leads: Math.floor(metrics.daily.leads_captured * 1.1),\n    expected_conversions: Math.floor(metrics.daily.conversions * 1.05),\n    expected_revenue: Math.floor(metrics.daily.revenue_generated * 1.05),\n    confidence: '85%'\n  }\n};\n\nreturn [{ json: performanceReport }];"
      },
      "id": "t0u1v2w3-x4y5-6789-3456-012345678901",
      "name": "ğŸ§® ROI Analytics Engine",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [340, 1500],
      "notes": "Comprehensive performance analytics with AI-powered insights and optimization recommendations"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "serviceAccountEmail": "zbenzap-sniper@stellar-verve-457002-p2.iam.gserviceaccount.com",
        "operation": "appendOrUpdate",
        "documentId": "{{ $vars.GOOGLE_SHEETS_LEADS_ID }}",
        "sheetName": "Daily_Performance",
        "columnToMatchOn": "A",
        "valueToMatchOn": "{{ new Date().toISOString().split('T')[0] }}",
        "valuesToSend": {
          "specifyColumns": "defineBelow",
          "columnsToSend": {
            "A": "{{ new Date().toISOString().split('T')[0] }}",
            "B": "{{ $json.metrics.daily.leads_captured }}",
            "C": "{{ $json.metrics.daily.messages_sent }}",
            "D": "{{ $json.metrics.daily.responses_received }}",
            "E": "{{ $json.metrics.daily.visits_scheduled }}",
            "F": "{{ $json.metrics.daily.conversions }}",
            "G": "{{ $json.metrics.daily.revenue_generated }}",
            "H": "{{ $json.metrics.daily.response_rate }}%",
            "I": "{{ $json.metrics.daily.sales_conversion_rate }}%",
            "J": "{{ $json.metrics.daily.roi_percentage }}%",
            "K": "R$ {{ $json.metrics.daily.cost_per_acquisition }}",
            "L": "{{ $json.insights.join(' | ') }}",
            "M": "{{ $json.recommendations.join(' | ') }}",
            "N": "{{ $json.timestamp }}"
          }
        }
      },
      "id": "u1v2w3x4-y5z6-7890-4567-123456789012",
      "name": "ğŸ“ˆ Save Performance Report",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [580, 1500],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "google-sheets-credentials",
          "name": "Google Sheets Fitness Academy"
        }
      },
      "notes": "Saves daily performance metrics to Google Sheets dashboard"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false
          },
          "conditions": [
            {
              "leftValue": "={{ $json.alerts.filter(alert => alert.action_required).length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ]
        }
      },
      "id": "v2w3x4y5-z6a7-8901-5678-234567890123",
      "name": "ğŸš¨ Performance Alert Filter",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [820, 1500]
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "send",
        "phoneNumberId": "{{ $vars.WHATSAPP_PHONE_ID }}",
        "recipientPhoneNumber": "{{ $vars.MANAGER_WHATSAPP }}",
        "messageType": "text",
        "textBody": "ğŸš¨ ALERTA DE PERFORMANCE - {{ new Date().toLocaleDateString('pt-BR') }}\\n\\nâš ï¸ AÃ‡Ã•ES NECESSÃRIAS:\\n\\n{{ $json.alerts.filter(alert => alert.action_required).map(alert => `â€¢ ${alert.message}`).join('\\n') }}\\n\\nğŸ“Š MÃ‰TRICAS HOJE:\\nâ€¢ Leads: {{ $json.metrics.daily.leads_captured }}\\nâ€¢ ConversÃµes: {{ $json.metrics.daily.conversions }}\\nâ€¢ ROI: {{ $json.metrics.daily.roi_percentage }}%\\n\\nğŸ’¡ RECOMENDAÃ‡Ã•ES:\\n{{ $json.recommendations.slice(0,3).map(rec => `â€¢ ${rec}`).join('\\n') }}\\n\\nğŸ“± Acesse o dashboard completo: sheets.google.com/dashboard"
      },
      "id": "w3x4y5z6-a7b8-9012-6789-345678901234",
      "name": "ğŸ“± Send Alert to Manager",
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [1060, 1500],
      "credentials": {
        "whatsAppApi": {
          "id": "whatsapp-business-credentials",
          "name": "WhatsApp Business API"
        }
      },
      "notes": "Sends performance alerts to management when action is required"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "{{ { \"status\": \"success\", \"message\": \"Lead processed successfully\", \"leadId\": $json.leadId, \"timestamp\": new Date().toISOString() } }}",
        "options": {}
      },
      "id": "x4y5z6a7-b8c9-0123-7890-456789012345",
      "name": "âœ… Lead Capture Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [1300, 300],
      "notes": "Confirms successful lead processing to source system"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "{{ { \"status\": \"success\", \"message\": \"Message processed\", \"intent\": $json.intent, \"response_sent\": $json.actionRequired === 'auto_respond', \"timestamp\": new Date().toISOString() } }}",
        "options": {}
      },
      "id": "y5z6a7b8-c9d0-1234-8901-567890123456",
      "name": "âœ… WhatsApp Response Confirmation",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [1060, 800],
      "notes": "Confirms message processing to WhatsApp webhook"
    }
  ],
  "connections": {
    "ğŸ¯ Lead Capture Hub": {
      "main": [
        [
          {
            "node": "ğŸ§  AI Lead Qualification Engine",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ§  AI Lead Qualification Engine": {
      "main": [
        [
          {
            "node": "ğŸ“Š Log to Analytics Dashboard",
            "type": "main",
            "index": 0
          },
          {
            "node": "âœ… Validate Contact Info",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… Validate Contact Info": {
      "main": [
        [
          {
            "node": "ğŸ”¥ Hot Lead Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”¥ Hot Lead Filter": {
      "main": [
        [
          {
            "node": "âš¡ Instant Hot Lead Response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "â° Smart Timing Buffer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "â° Smart Timing Buffer": {
      "main": [
        [
          {
            "node": "ğŸ“± Interactive Menu Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš¡ Instant Hot Lead Response": {
      "main": [
        [
          {
            "node": "âœ… Lead Capture Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Interactive Menu Response": {
      "main": [
        [
          {
            "node": "âœ… Lead Capture Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ’¬ WhatsApp Response Handler": {
      "main": [
        [
          {
            "node": "ğŸ¤– AI Response Intelligence",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– AI Response Intelligence": {
      "main": [
        [
          {
            "node": "ğŸ“ˆ Conversation Analytics",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ¤– Auto Response Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– Auto Response Filter": {
      "main": [
        [
          {
            "node": "ğŸ’¬ AI Auto Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ’¬ AI Auto Response": {
      "main": [
        [
          {
            "node": "âœ… WhatsApp Response Confirmation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ˆ Conversation Analytics": {
      "main": [
        [
          {
            "node": "âœ… WhatsApp Response Confirmation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "â° Daily Follow-up Trigger": {
      "main": [
        [
          {
            "node": "ğŸ“‹ Get Leads for Follow-up",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Get Leads for Follow-up": {
      "main": [
        [
          {
            "node": "ğŸ¯ Behavioral Follow-up Engine",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¯ Behavioral Follow-up Engine": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Send Follow-up Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¤ Send Follow-up Messages": {
      "main": [
        [
          {
            "node": "ğŸ“Š Log Follow-up Analytics",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ˆ Daily ROI Analytics": {
      "main": [
        [
          {
            "node": "ğŸ§® ROI Analytics Engine",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ§® ROI Analytics Engine": {
      "main": [
        [
          {
            "node": "ğŸ“ˆ Save Performance Report",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸš¨ Performance Alert Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸš¨ Performance Alert Filter": {
      "main": [
        [
          {
            "node": "ğŸ“± Send Alert to Manager",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "saveDataErrorExecution": "all",
    "saveDataSuccessExecution": "all",
    "timezone": "America/Sao_Paulo",
    "executionTimeout": 1200,
    "maxTimeout": 3600
  },
  "staticData": {},
  "tags": [
    {
      "createdAt": "2024-09-22T12:00:00.000Z",
      "updatedAt": "2024-09-22T12:00:00.000Z",
      "id": "1",
      "name": "ğŸš€ Disruptive"
    },
    {
      "createdAt": "2024-09-22T12:00:00.000Z",
      "updatedAt": "2024-09-22T12:00:00.000Z",
      "id": "2",
      "name": "ğŸ’ª Fitness Academy"
    },
    {
      "createdAt": "2024-09-22T12:00:00.000Z",
      "updatedAt": "2024-09-22T12:00:00.000Z",
      "id": "3",
      "name": "ğŸ¤– AI-Powered"
    },
    {
      "createdAt": "2024-09-22T12:00:00.000Z",
      "updatedAt": "2024-09-22T12:00:00.000Z",
      "id": "4",
      "name": "ğŸ“ˆ ROI Optimized"
    }
  ],
  "triggerCount": 3,
  "updatedAt": "2024-09-22T12:00:00.000Z",
  "versionId": "1.0.0",
  "meta": {
    "instanceId": "fitness_academy_disruptive_v1"
  }
}